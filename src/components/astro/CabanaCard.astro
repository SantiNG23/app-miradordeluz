---
import type { Cabana } from '../../utils/types';
import { formatCurrency } from '../../utils/formatters';

interface Props {
  cabana: Cabana;
}

const { cabana } = Astro.props;
const imagenPrincipal = cabana.imagenes?.find(img => img.es_principal) || cabana.imagenes?.[0];
---

<article class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
  <!-- Imagen -->
  <div class="relative h-64 bg-gray-200 overflow-hidden">
    {imagenPrincipal ? (
      <img 
        src={imagenPrincipal.url} 
        alt={imagenPrincipal.alt || `Vista de ${cabana.nombre}`}
        class="w-full h-full object-cover transition-transform duration-300 hover:scale-110"
        loading="lazy"
      />
    ) : (
      <div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-200 to-gray-300">
        <svg class="w-20 h-20 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      </div>
    )}
    
    <!-- Badge de capacidad -->
    <div class="absolute top-4 right-4 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full text-sm font-semibold text-gray-700">
      ğŸ‘¥ {cabana.capacidad_personas} personas
    </div>
  </div>
  
  <!-- Contenido -->
  <div class="p-6">
    <h3 class="text-2xl font-bold mb-2 text-gray-900">
      {cabana.nombre}
    </h3>
    
    <p class="text-gray-600 mb-4 line-clamp-2">
      {cabana.descripcion}
    </p>
    
    <!-- CaracterÃ­sticas -->
    <div class="flex items-center gap-4 mb-4 text-sm text-gray-500">
      <span class="flex items-center gap-1">
        ğŸ›ï¸ {cabana.habitaciones} hab.
      </span>
      <span class="flex items-center gap-1">
        ğŸš¿ {cabana.banos} baÃ±o{cabana.banos > 1 ? 's' : ''}
      </span>
      {cabana.metros_cuadrados && (
        <span class="flex items-center gap-1">
          ğŸ“ {cabana.metros_cuadrados}mÂ²
        </span>
      )}
    </div>
    
    <!-- Amenities destacados -->
    {cabana.amenities && cabana.amenities.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-4">
        {cabana.amenities.slice(0, 3).map(amenity => (
          <span class="text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded">
            {amenity.nombre}
          </span>
        ))}
        {cabana.amenities.length > 3 && (
          <span class="text-xs text-gray-500">
            +{cabana.amenities.length - 3} mÃ¡s
          </span>
        )}
      </div>
    )}
    
    <!-- Precio y botÃ³n -->
    <div class="flex items-center justify-between pt-4 border-t border-gray-100">
      <div>
        <span class="text-sm text-gray-500 block">Desde</span>
        <span class="text-2xl font-bold text-blue-600">
          {formatCurrency(cabana.precio_base)}
        </span>
        <span class="text-sm text-gray-500">/noche</span>
      </div>
      
      <a 
        href={`/cabanas/${cabana.slug}`}
        class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-semibold shadow-md hover:shadow-lg"
      >
        Ver Detalles
      </a>
    </div>
  </div>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

